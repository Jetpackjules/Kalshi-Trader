<!DOCTYPE html>
<html>
<head>
    <title>CSV Load Test</title>
</head>
<body>
    <h1>CSV Load Test</h1>
    <button onclick="testLoad()">Test Load CSV</button>
    <div id="output"></div>
    
    <script>
        async function testLoad() {
            try {
                console.log('Loading CSV...');
                const response = await fetch('data/candles/KXHIGHNY_candles_5m.csv');
                console.log('Response status:', response.status);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const csvText = await response.text();
                console.log('CSV loaded, length:', csvText.length);
                
                const lines = csvText.trim().split('\n');
                console.log('Number of lines:', lines.length);
                console.log('First few lines:', lines.slice(0, 5));
                
                // Parse data
                const marketGroups = {};
                for (let i = 1; i < Math.min(lines.length, 20); i++) {
                    const values = lines[i].split(',');
                    if (values.length >= 7) {
                        const ticker = values[1];
                        if (!marketGroups[ticker]) {
                            marketGroups[ticker] = 0;
                        }
                        marketGroups[ticker]++;
                    }
                }
                
                console.log('Market groups found:', Object.keys(marketGroups).length);
                console.log('Market groups:', marketGroups);
                
                document.getElementById('output').innerHTML = `
                    <h3>Results:</h3>
                    <p>CSV Lines: ${lines.length}</p>
                    <p>Markets Found: ${Object.keys(marketGroups).length}</p>
                    <pre>${JSON.stringify(marketGroups, null, 2)}</pre>
                `;
                
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('output').innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>